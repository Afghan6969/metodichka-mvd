# üîç –û–¢–õ–ê–î–ö–ê: –õ–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è, –Ω–æ –Ω–µ –≤–∏–¥–Ω—ã –≤ –ë–î

## –ü—Ä–æ–±–ª–µ–º–∞
```
[AddUser API] –õ–æ–≥ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: Test_Test
```
–ù–æ –≤ Supabase Table Editor –∑–∞–ø–∏—Å–∏ –Ω–µ –≤–∏–¥–Ω–æ, —Ö–æ—Ç—è –Ω–∞ —Å–∞–π—Ç–µ –æ–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è.

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1. **–†–∞–∑–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã Supabase**
–í—ã —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –æ–¥–∏–Ω –ø—Ä–æ–µ–∫—Ç, –∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–∏—à–µ—Ç –≤ –¥—Ä—É–≥–æ–π.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –û—Ç–∫—Ä–æ–π—Ç–µ `.env.local` (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `NEXT_PUBLIC_SUPABASE_URL` - —ç—Ç–æ URL –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ Supabase Dashboard –æ—Ç–∫—Ä—ã—Ç –≠–¢–û–¢ –ø—Ä–æ–µ–∫—Ç

### 2. **–§–∏–ª—å—Ç—Ä—ã –≤ Table Editor**
–í Table Editor –º–æ–≥—É—Ç –±—ã—Ç—å –∞–∫—Ç–∏–≤–Ω—ã —Ñ–∏–ª—å—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–∫—Ä—ã–≤–∞—é—Ç –∑–∞–ø–∏—Å–∏.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –í Table Editor –Ω–∞–∂–º–∏—Ç–µ "Clear filters"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ `created_at DESC`

### 3. **–í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏**
Supabase –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö (—Ä–µ–¥–∫–æ, –Ω–æ –±—ã–≤–∞–µ—Ç).

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ 30 —Å–µ–∫—É–Ω–¥ –∏ –æ–±–Ω–æ–≤–∏—Ç–µ Table Editor (F5)

### 4. **–ü—Ä–æ–±–ª–µ–º–∞ —Å —á–∞—Å–æ–≤—ã–º –ø–æ—è—Å–æ–º**
–ó–∞–ø–∏—Å–∏ –º–æ–≥—É—Ç –±—ã—Ç—å, –Ω–æ —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º, –ø–æ—ç—Ç–æ–º—É –Ω–µ –≤–∏–¥–Ω—ã –≤ —Å–ø–∏—Å–∫–µ.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –í SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

## üöÄ –®–∞–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –®–∞–≥ 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (Ctrl+C)
npm run dev
```

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏"
3. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –Ω–∏–∫–Ω–µ–π–º–æ–º `DEBUG_TEST_USER`

### –®–∞–≥ 3: –°–º–æ—Ç—Ä–µ—Ç—å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª
–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –ª–æ–≥–∏:
```
[AddUser API] –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞: { action: 'add_user', ... }
[AddUser API] ‚úÖ –õ–æ–≥ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: DEBUG_TEST_USER
[AddUser API] –í—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å: [ { id: 123, ... } ]
[AddUser API] ID –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–∞: 123
[AddUser API] ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞: –ª–æ–≥ –Ω–∞–π–¥–µ–Ω –≤ –ë–î: { id: 123, ... }
```

**–í–∞–∂–Ω–æ:** –ó–∞–ø–∏—à–∏—Ç–µ ID –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 123)

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Supabase SQL Editor
–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∑–∞–ø—Ä–æ—Å —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º ID:

```sql
-- –ó–∞–º–µ–Ω–∏—Ç–µ 123 –Ω–∞ ID –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
SELECT * FROM user_logs WHERE id = 123;
```

**–ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –ù–ï –Ω–∞–π–¥–µ–Ω–∞** - –∑–Ω–∞—á–∏—Ç –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î –∏–ª–∏ —Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã.

**–ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –Ω–∞–π–¥–µ–Ω–∞** - –∑–Ω–∞—á–∏—Ç –ø—Ä–æ–±–ª–µ–º–∞ –≤ Table Editor (—Ñ–∏–ª—å—Ç—Ä—ã, –∫—ç—à).

### –®–∞–≥ 5: –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
–í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª `scripts/020_debug_user_logs.sql`:

```sql
-- 1. –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–≥–æ–≤
SELECT COUNT(*) FROM user_logs;

-- 2. –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 –∑–∞–ø–∏—Å–µ–π
SELECT id, action, target_user_nickname, created_at 
FROM user_logs 
ORDER BY created_at DESC 
LIMIT 20;

-- 3. –ü–æ–∏—Å–∫ –ø–æ –Ω–∏–∫–Ω–µ–π–º—É
SELECT * FROM user_logs 
WHERE target_user_nickname ILIKE '%DEBUG_TEST%'
ORDER BY created_at DESC;

-- 4. –õ–æ–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –º–∏–Ω—É—Ç
SELECT * FROM user_logs 
WHERE created_at > NOW() - INTERVAL '10 minutes'
ORDER BY created_at DESC;
```

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL –ø—Ä–æ–µ–∫—Ç–∞
–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–µ–Ω URL Supabase:

```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –∫–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
console.log("Supabase URL:", process.env.NEXT_PUBLIC_SUPABASE_URL);
```

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —ç—Ç–æ—Ç URL —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å URL –≤ Supabase Dashboard.

## üìä –ß—Ç–æ –ø–æ–∫–∞–∂—É—Ç –Ω–æ–≤—ã–µ –ª–æ–≥–∏

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã —É–≤–∏–¥–∏—Ç–µ:

### –ï—Å–ª–∏ –≤—Å—ë –û–ö:
```
[AddUser API] –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞: { ... }
[AddUser API] ‚úÖ –õ–æ–≥ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω
[AddUser API] ID –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–∞: 456
[AddUser API] ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞: –ª–æ–≥ –Ω–∞–π–¥–µ–Ω –≤ –ë–î: { id: 456, action: 'add_user', ... }
```

### –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏:
```
[AddUser API] –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞: { ... }
[AddUser API] ‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞: { ... }
[AddUser API] Log error code: 42501
[AddUser API] Log error message: permission denied
```

### –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –µ—Å—Ç—å, –Ω–æ –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è:
```
[AddUser API] ‚úÖ –õ–æ–≥ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω
[AddUser API] ID –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–∞: 789
[AddUser API] ‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –ª–æ–≥: { ... }
```

## üéØ –†–µ—à–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

### –°–ª—É—á–∞–π 1: –û—à–∏–±–∫–∞ "permission denied"
```sql
-- –û—Ç–∫–ª—é—á–∏—Ç—å RLS
ALTER TABLE user_logs DISABLE ROW LEVEL SECURITY;
```

### –°–ª—É—á–∞–π 2: –ó–∞–ø–∏—Å—å –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ
–ü—Ä–æ–±–ª–µ–º–∞ —Å RLS –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏ –¥–ª—è SELECT:
```sql
-- –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø–æ–ª–∏—Ç–∏–∫–∏
DROP POLICY IF EXISTS "Enable read access for all users" ON user_logs;
```

### –°–ª—É—á–∞–π 3: –†–∞–∑–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env.local`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `NEXT_PUBLIC_SUPABASE_URL` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å URL –≤ Dashboard

### –°–ª—É—á–∞–π 4: –ó–∞–ø–∏—Å–∏ –µ—Å—Ç—å, –Ω–æ –Ω–µ –≤–∏–¥–Ω—ã –≤ Table Editor
- –û—á–∏—Å—Ç–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤ Table Editor
- –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5)
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ SQL Editor –≤–º–µ—Å—Ç–æ Table Editor

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
2. **–î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** `DEBUG_TEST_USER`
3. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–°–ï –ª–æ–≥–∏** –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
4. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∑–∞–ø—Ä–æ—Å—ã** –∏–∑ `scripts/020_debug_user_logs.sql`
5. **–°–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - —á—Ç–æ –ø–æ–∫–∞–∑–∞–ª–∏ –ª–æ–≥–∏ –∏ SQL –∑–∞–ø—Ä–æ—Å—ã

## üîß –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ –ª–æ–≥–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å:
- –õ–æ–≥–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ (–∏–∑ API)
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ—Å—Ç–æ –∏—Å—Ç–æ—Ä–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã, –ª–æ–≥–∏ –Ω–∞—á–Ω—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è

---

**–í–∞–∂–Ω–æ:** –ù–æ–≤—ã–π –∫–æ–¥ –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å–µ –ª–æ–≥–∏ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞.
